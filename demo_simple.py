#!/usr/bin/env python3
"""
Freee MCP Scalar - æœˆæ¬¡æ¨ç§»è¡¨ä½œæˆãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
pandasã‚’ä½¿ã‚ãªã„ã‚·ãƒ³ãƒ—ãƒ«ç‰ˆ
"""

def simulate_freee_mcp_execution():
    """Freee MCP Scalarã®å®Ÿè¡Œã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ"""
    
    print("ğŸ¤– Freee MCP Scalar - æœˆæ¬¡æ¨ç§»è¡¨ä½œæˆãƒ‡ãƒ¢")
    print("=" * 60)
    print()
    print("ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼: ã€Œå‹˜å®šç§‘ç›®åˆ¥ã§2025å¹´1æœˆã‹ã‚‰5æœˆã®æœˆæ¬¡æ¨ç§»è¡¨ã‚’ä½œã£ã¦ãã ã•ã„ã€")
    print()
    print("ğŸ”„ Claude + MCPå®Ÿè¡Œä¸­...")
    print("   âœ“ get_companies - ä¼šç¤¾æƒ…å ±å–å¾—")
    print("   âœ“ get_account_items - å‹˜å®šç§‘ç›®ä¸€è¦§å–å¾—") 
    print("   âœ“ get_trial_pl (2025-01-01 to 2025-01-31) - 1æœˆPLè©¦ç®—è¡¨å–å¾—")
    print("   âœ“ get_trial_pl (2025-02-01 to 2025-02-28) - 2æœˆPLè©¦ç®—è¡¨å–å¾—")
    print("   âœ“ get_trial_pl (2025-03-01 to 2025-03-31) - 3æœˆPLè©¦ç®—è¡¨å–å¾—")
    print("   âœ“ get_trial_pl (2025-04-01 to 2025-04-30) - 4æœˆPLè©¦ç®—è¡¨å–å¾—")
    print("   âœ“ get_trial_pl (2025-05-01 to 2025-05-31) - 5æœˆPLè©¦ç®—è¡¨å–å¾—")
    print("   âœ“ ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ»åˆ†æãƒ»ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆä¸­...")
    print()
    
    # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸfreeeãƒ‡ãƒ¼ã‚¿
    monthly_data = {
        "1æœˆ": {
            "å£²ä¸Šé«˜": 12500000,
            "å£²ä¸ŠåŸä¾¡": 7500000,
            "åœ°ä»£å®¶è³ƒ": 500000,
            "çµ¦ä¸æ‰‹å½“": 2800000,
            "æ—…è²»äº¤é€šè²»": 85000,
            "é€šä¿¡è²»": 45000,
            "æ¶ˆè€—å“è²»": 25000,
            "åºƒå‘Šå®£ä¼è²»": 150000
        },
        "2æœˆ": {
            "å£²ä¸Šé«˜": 13200000,
            "å£²ä¸ŠåŸä¾¡": 7920000,
            "åœ°ä»£å®¶è³ƒ": 500000,
            "çµ¦ä¸æ‰‹å½“": 2800000,
            "æ—…è²»äº¤é€šè²»": 120000,
            "é€šä¿¡è²»": 47000,
            "æ¶ˆè€—å“è²»": 30000,
            "åºƒå‘Šå®£ä¼è²»": 180000
        },
        "3æœˆ": {
            "å£²ä¸Šé«˜": 11800000,
            "å£²ä¸ŠåŸä¾¡": 7080000,
            "åœ°ä»£å®¶è³ƒ": 500000,
            "çµ¦ä¸æ‰‹å½“": 2800000,
            "æ—…è²»äº¤é€šè²»": 95000,
            "é€šä¿¡è²»": 48000,
            "æ¶ˆè€—å“è²»": 22000,
            "åºƒå‘Šå®£ä¼è²»": 160000
        },
        "4æœˆ": {
            "å£²ä¸Šé«˜": 14100000,
            "å£²ä¸ŠåŸä¾¡": 8460000,
            "åœ°ä»£å®¶è³ƒ": 500000,
            "çµ¦ä¸æ‰‹å½“": 2950000,
            "æ—…è²»äº¤é€šè²»": 140000,
            "é€šä¿¡è²»": 49000,
            "æ¶ˆè€—å“è²»": 35000,
            "åºƒå‘Šå®£ä¼è²»": 200000
        },
        "5æœˆ": {
            "å£²ä¸Šé«˜": 13700000,
            "å£²ä¸ŠåŸä¾¡": 8220000,
            "åœ°ä»£å®¶è³ƒ": 500000,
            "çµ¦ä¸æ‰‹å½“": 2950000,
            "æ—…è²»äº¤é€šè²»": 110000,
            "é€šä¿¡è²»": 51000,
            "æ¶ˆè€—å“è²»": 28000,
            "åºƒå‘Šå®£ä¼è²»": 170000
        }
    }
    
    print("ğŸ¤– Claudeã®å›ç­”:")
    print()
    print("ğŸ“ˆ å‹˜å®šç§‘ç›®åˆ¥æœˆæ¬¡æ¨ç§»è¡¨ï¼ˆ2025å¹´1æœˆã€œ5æœˆï¼‰")
    print("ğŸ¢ å¯¾è±¡ä¼šç¤¾: ã‚µãƒ³ãƒ—ãƒ«æ ªå¼ä¼šç¤¾")
    print()
    
    # ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ
    print("â”Œ" + "â”€" * 14 + "â”¬" + "â”€" * 12 + "â”¬" + "â”€" * 12 + "â”¬" + "â”€" * 12 + "â”¬" + "â”€" * 12 + "â”¬" + "â”€" * 12 + "â”")
    print("â”‚{:^14}â”‚{:^12}â”‚{:^12}â”‚{:^12}â”‚{:^12}â”‚{:^12}â”‚".format("å‹˜å®šç§‘ç›®", "1æœˆ", "2æœˆ", "3æœˆ", "4æœˆ", "5æœˆ"))
    print("â”œ" + "â”€" * 14 + "â”¼" + "â”€" * 12 + "â”¼" + "â”€" * 12 + "â”¼" + "â”€" * 12 + "â”¼" + "â”€" * 12 + "â”¼" + "â”€" * 12 + "â”¤")
    
    # ãƒ‡ãƒ¼ã‚¿è¡Œ
    accounts = ["å£²ä¸Šé«˜", "å£²ä¸ŠåŸä¾¡", "åœ°ä»£å®¶è³ƒ", "çµ¦ä¸æ‰‹å½“", "æ—…è²»äº¤é€šè²»", "é€šä¿¡è²»", "æ¶ˆè€—å“è²»", "åºƒå‘Šå®£ä¼è²»"]
    
    for account in accounts:
        print("â”‚{:14}â”‚{:>11,}â”‚{:>11,}â”‚{:>11,}â”‚{:>11,}â”‚{:>11,}â”‚".format(
            account,
            monthly_data["1æœˆ"][account],
            monthly_data["2æœˆ"][account], 
            monthly_data["3æœˆ"][account],
            monthly_data["4æœˆ"][account],
            monthly_data["5æœˆ"][account]
        ))
    
    print("â””" + "â”€" * 14 + "â”´" + "â”€" * 12 + "â”´" + "â”€" * 12 + "â”´" + "â”€" * 12 + "â”´" + "â”€" * 12 + "â”´" + "â”€" * 12 + "â”˜")
    
    print()
    print("ğŸ’¡ ä¸»è¦ãªåˆ†æ:")
    
    # å£²ä¸Šåˆ†æ
    jan_revenue = monthly_data["1æœˆ"]["å£²ä¸Šé«˜"]
    may_revenue = monthly_data["5æœˆ"]["å£²ä¸Šé«˜"]
    revenue_change = (may_revenue - jan_revenue) / jan_revenue * 100
    print(f"â€¢ å£²ä¸Šé«˜: {revenue_change:+.1f}% (1æœˆâ†’5æœˆ)")
    
    # æœ€é«˜ãƒ»æœ€ä½å£²ä¸Šæœˆ
    revenues = {month: data["å£²ä¸Šé«˜"] for month, data in monthly_data.items()}
    max_month = max(revenues, key=revenues.get)
    min_month = min(revenues, key=revenues.get)
    print(f"â€¢ å£²ä¸Šæœ€é«˜æœˆ: {max_month} (Â¥{revenues[max_month]:,})")
    print(f"â€¢ å£²ä¸Šæœ€ä½æœˆ: {min_month} (Â¥{revenues[min_month]:,})")
    
    # å›ºå®šè²»
    print(f"â€¢ åœ°ä»£å®¶è³ƒ: å…¨æœŸé–“å®‰å®š (Â¥{monthly_data['1æœˆ']['åœ°ä»£å®¶è³ƒ']:,}/æœˆ)")
    
    # çµ¦ä¸å¤‰åŒ–
    jan_salary = monthly_data["1æœˆ"]["çµ¦ä¸æ‰‹å½“"]
    apr_salary = monthly_data["4æœˆ"]["çµ¦ä¸æ‰‹å½“"]
    if apr_salary > jan_salary:
        salary_increase = apr_salary - jan_salary
        print(f"â€¢ çµ¦ä¸æ‰‹å½“: 4æœˆã‹ã‚‰å¢—åŠ  (+Â¥{salary_increase:,})")
    
    # æ—…è²»åˆ†æ
    travels = {month: data["æ—…è²»äº¤é€šè²»"] for month, data in monthly_data.items()}
    max_travel_month = max(travels, key=travels.get)
    print(f"â€¢ æ—…è²»äº¤é€šè²»: {max_travel_month}ãŒæœ€å¤§ (Â¥{travels[max_travel_month]:,})")
    
    print()
    print("ğŸ“ˆ æˆé•·ç‡ãƒˆãƒ¬ãƒ³ãƒ‰ (å‰æœˆæ¯”):")
    
    months = ["1æœˆ", "2æœˆ", "3æœˆ", "4æœˆ", "5æœˆ"]
    for i in range(1, len(months)):
        prev_month = months[i-1]
        curr_month = months[i]
        prev_revenue = monthly_data[prev_month]["å£²ä¸Šé«˜"]
        curr_revenue = monthly_data[curr_month]["å£²ä¸Šé«˜"]
        growth_rate = (curr_revenue - prev_revenue) / prev_revenue * 100
        print(f"â€¢ {curr_month}: {growth_rate:+.1f}%")
    
    print()
    print("ğŸ” å£²ä¸ŠåŸä¾¡ç‡:")
    for month in months:
        revenue = monthly_data[month]["å£²ä¸Šé«˜"]
        cogs = monthly_data[month]["å£²ä¸ŠåŸä¾¡"]
        cogs_rate = cogs / revenue * 100
        print(f"â€¢ {month}: {cogs_rate:.1f}%")
    
    print()
    print("ğŸ“ åˆ©ç”¨å¯èƒ½ãªã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå½¢å¼:")
    print("â€¢ CSVå½¢å¼ (.csv)")
    print("â€¢ Excelå½¢å¼ (.xlsx)")
    print("â€¢ PDFå½¢å¼ (.pdf)")
    print("â€¢ Google Sheetsé€£æº")
    
    print()
    print("ğŸ”„ è¿½åŠ åˆ†æã‚ªãƒ—ã‚·ãƒ§ãƒ³:")
    print("â€¢ å‰å¹´åŒæœŸæ¯”è¼ƒ")
    print("â€¢ äºˆç®—å¯¾å®Ÿç¸¾åˆ†æ")
    print("â€¢ éƒ¨é–€åˆ¥å†…è¨³è¡¨ç¤º")
    print("â€¢ ã‚°ãƒ©ãƒ•ãƒ»ãƒãƒ£ãƒ¼ãƒˆç”Ÿæˆ")
    
    print()
    print("âœ¨ ã“ã®ãƒ¬ãƒãƒ¼ãƒˆãŒã€Œå‹˜å®šç§‘ç›®åˆ¥ã§2025å¹´1æœˆã‹ã‚‰5æœˆã®æœˆæ¬¡æ¨ç§»è¡¨ã‚’ä½œã£ã¦ã€")
    print("   ã¨ã„ã†ä¸€è¨€ã§è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸï¼")

if __name__ == "__main__":
    simulate_freee_mcp_execution()